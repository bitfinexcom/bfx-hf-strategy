<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Architectural Overview - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Tutorials</li><li class="nav-item"><a href="tutorial-Architectural Overview.html">Architectural Overview</a></li><li class="nav-item"><a href="tutorial-Backtesting Offline.html">Backtesting Offline</a></li><li class="nav-item"><a href="tutorial-Backtesting Online.html">Backtesting Online</a></li><li class="nav-item"><a href="tutorial-Live Execution.html">Live Execution</a></li><li class="nav-item"><a href="tutorial-Order Creation.html">Order Creation</a></li><li class="nav-item"><a href="tutorial-Strategy Design.html">Strategy Design</a></li><li class="nav-item"><a href="tutorial-Using Indicators.html">Using Indicators</a></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Backtest.html">Backtest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Backtest.html#.debugResults">debugResults</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Backtest.html#.execOffline">execOffline</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Backtest.html#.execOnline">execOnline</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Helpers.html">Helpers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.closeOpenPositions">h.closeOpenPositions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.closePosition">h.closePosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.closePositionLimit">h.closePositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.closePositionMarket">h.closePositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.closePositionWithOrder">h.closePositionWithOrder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.condition">h.condition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.condition.inAPosition">h.condition.inAPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.condition.indicatorCrossed">h.condition.indicatorCrossed</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.condition.indicatorsCrossed">h.condition.indicatorsCrossed</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.enforceMinTradeInterval">h.enforceMinTradeInterval</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.getLastPrice">h.getLastPrice</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.getState">h.getState</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.inALongPosition">h.inALongPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.inAPosition">h.inAPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.inAShortPosition">h.inAShortPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.indicatorValues">h.indicatorValues</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.minTradeIntervalMet">h.minTradeIntervalMet</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openLongPosition">h.openLongPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openLongPositionLimit">h.openLongPositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openLongPositionMarket">h.openLongPositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openPosition">h.openPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openPositionLimit">h.openPositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openPositionMarket">h.openPositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openPositionWithOrder">h.openPositionWithOrder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openShortPosition">h.openShortPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openShortPositionLimit">h.openShortPositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.openShortPositionMarket">h.openShortPositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateLongPosition">h.updateLongPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateLongPositionLimit">h.updateLongPositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateLongPositionMarket">h.updateLongPositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updatePosition">h.updatePosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updatePositionLimit">h.updatePositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updatePositionMarket">h.updatePositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updatePositionWithOrder">h.updatePositionWithOrder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateShortPosition">h.updateShortPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateShortPositionLimit">h.updateShortPositionLimit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.updateShortPositionMarket">h.updateShortPositionMarket</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.withNoPosition">h.withNoPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Helpers.html#.h.withPosition">h.withPosition</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#defineStrategy">defineStrategy</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">Architectural Overview</h1>
    

    <section>

<header>
    
</header>

<article>
    <h4>Defining a Strategy</h4>
<p>The <code>define</code> method is provided to construct a trading strategy from a set of
indicators &amp; update methods. Strategies created with it can be used with
<code>bfx-hf-backtest</code> or <code>bfx-hf-strategy-exec</code> to run on the live markets. An
example strategy follows below:</p>
<pre class="prettyprint source lang-js"><code>const { EMA } = require('bfx-hf-indicators')
const { SYMBOLS, TIME_FRAMES } = require('bfx-hf-util')
const HFS = require('bfx-hf-strategy')

const strategy = HFS.define({
  id: 'ema_cross',
  name: 'ema_cross',
  symbol: SYMBOLS.LEO_USD,    // default symbol
  tf: TIME_FRAMES.ONE_MINUTE, // default time frame

  // Assumes LEO balance > 1 and trading w/ affiliate code
  takerFee: (0.0002 * 0.95) * 0.85,
  makerFee: (0.0001 * 0.95) * 0.85,

  simulateLiveCandleEnabled: false, // keeps results deterministic

  indicators: { // indicator definition, automatically updated on each tick
    l: new EMA([100]),
    s: new EMA([20])
  },

  exec: async function () { // called on each trade/candle data point
    const { s, l } = this.indicatorValues()

    // Breaks execution at this location, on this tick, if the short and long
    // EMA indicators have not yet crossed.
    await this.condition.indicatorsCrossed('s', 'l')

    // Open a position with a market order if no position is open; otherwise
    // close the open position with a market order.
    if (!this.inAPosition()) {
      return this.openPositionMarket({ amount: s > l ? 6 : -6 })
    } else {
      return this.closePositionMarket()
    }
  }
})
</code></pre>
<p>The above strategy defines two EMA indicators, <code>l</code> and <code>s</code>, with periods of 100
and 20 respectively, and an <code>exec</code> method that holds the strategy logic. Within
<code>exec</code> a <strong>condition</strong> is defined which breaks execution at that point in the
function if the two indicators, <code>s</code> and <code>l</code> (short and long EMAs respectively)
have not crossed values. For a full list of possible conditions, refer to the
<a href="module-Helpers.html"><code>module:Helpers</code></a> documentation.</p>
<p>If the indicators have crossed values on this tick, execution continues to the
position check, at which point either a new position is opened with an order size
of <code>6</code> LEO, or a previously opened position is closed. In either case a MARKET
order is used.</p>
<h4>Managing Positions</h4>
<p>Within the <code>exec</code> function, several async helpers are available to
open/update/close positions:</p>
<ul>
<li><a href="module-Helpers.html#.h.openLongPositionMarket"><code>openLongPositionMarket(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openLongPositionLimit"><code>openLongPositionLimit(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openLongPosition"><code>openLongPosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openShortPositionMarket"><code>openShortPositionMarket(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openShortPositionLimit"><code>openShortPositionLimit(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openShortPosition"><code>openShortPosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.openPosition"><code>openPosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateLongPositionMarket"><code>updateLongPositionMarket(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateLongPositionLimit"><code>updateLongPositionLimit(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateLongPosition"><code>updateLongPosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateShortPositionMarket"><code>updateShortPositionMarket(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateShortPositionLimit"><code>updateShortPositionLimit(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updateShortPosition"><code>updateShortPosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.updatePosition"><code>updatePosition(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.closePositionMarket"><code>closePositionMarket(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.closePositionLimit"><code>closePositionLimit(params = {})</code></a></li>
<li><a href="module-Helpers.html#.h.closePosition"><code>closePosition(params = {})</code></a></li>
</ul>
<p>The <code>price</code> and <code>mtsCreate</code> order timestamp are automatically passed to the
created order (<code>price</code> is needed for MARKET orders if backtesting) based on the
last received data for the strategy's symbol.</p>
<h4>Executing on Live Markets</h4>
<p>To run a strategy on the live marketplace, refer to the <a href="tutorial-Live Execution.html">Live Execution</a> tutorial.</p>
</article>

</section>

</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Sat Mar 14 2020 21:59:47 GMT+0700 (Indochina Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>